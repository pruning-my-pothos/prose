---
import ArticleLayout from '../../layouts/ArticleLayout.astro';
import { getCollection } from 'astro:content';
import { readingTime } from '../../utils/readingTime';
import { isPublished } from '../../utils/content';

export async function getStaticPaths() {
  const entries = await getCollection('philosophy', isPublished);
  return entries.map((item) => ({ params: { slug: item.slug }, props: { item } }));
}

const { item } = Astro.props;
const { Content } = await item.render();
const reading = readingTime(item.body);
---
<ArticleLayout title={item.data.title} description={item.data.description}>
  <header>
    <div class="meta-row">
      <span class="badge">Philosophy</span>
      <span class="divider"></span>
      <span>{item.data.date.toLocaleDateString()}</span>
      <span class="divider"></span>
      <span>{reading.label}</span>
    </div>
    <h1>{item.data.title}</h1>
    <p class="muted">{item.data.description}</p>
    <div style="margin-top:0.6rem;">
      {item.data.tags.map((tag) => (
        <span class="tag">{tag}</span>
      ))}
    </div>
  </header>

  <Content />
</ArticleLayout>
