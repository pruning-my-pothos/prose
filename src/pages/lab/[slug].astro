---
import ArticleLayout from '../../layouts/ArticleLayout.astro';
import { getCollection } from 'astro:content';
import { isPublished } from '../../utils/content';

export async function getStaticPaths() {
  const entries = await getCollection('lab', isPublished);
  return entries.map((item) => ({ params: { slug: item.slug }, props: { item } }));
}

const { item } = Astro.props;
const { Content } = await item.render();
---
<ArticleLayout title={item.data.title} description={item.data.description}>
  <header>
    <p class="muted">Lab Â· {item.data.date.toLocaleDateString()}</p>
    <h1>{item.data.title}</h1>
    <p class="muted">{item.data.description}</p>
    <div class="meta-row" style="margin-top:0.6rem;">
      <span class="badge">Hypothesis</span>
      <span>{item.data.hypothesis}</span>
    </div>
    <div style="margin-top:0.6rem;">
      {item.data.tags.map((tag) => (
        <span class="tag">{tag}</span>
      ))}
    </div>
  </header>

  <section>
    <h2>Build notes</h2>
    <p>{item.data.build_notes}</p>
    <Content />
  </section>

  <section>
    <h2>Next iteration</h2>
    <p>{item.data.next_iteration}</p>
  </section>
</ArticleLayout>
